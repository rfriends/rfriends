rfriends3はキーワードをもとにラジオ番組を検索、録音（ダウンロード）します。  
  
### １）キーワードの書き方  
  
一行のカンマ区切りで検索キーワードを記述します。これを複数行書いていきます。  
一行内のキーワードはAND条件、行のキーワードはOR条件になります。  
キーワードの先頭に ! をつけるとNOT条件になります。ただし行の先頭のキーワードでは使用できません。  
キーワードの先頭に +をつけると番組名のみの検索になります。  
  
例：(+kw11 and kw12 and kw13) or (kw21 and (not kw22))  
  
+kw11,kw12,kw13,...  
kw21,!kw22,...  
  
例：番組名がオールナイトニッポン全番組で、かつ、MUSIC10でないもの  
+オールナイトニッポン,!MUSIC10  
  
### ２）キーワードのヒント  
  
　専用キーワードには番組名（の一部）を指定すると確実です。  
　共通キーワードには、個人名、グループ名を指定すると、応援している人が出演した番組を逃さない可能性が高くなります。  
　パーソナリティを指定した場合、その人の番組およびゲスト出演の番組も録音される可能性があります。  
　歌手名を指定した場合、出演番組だけでなく、その人の曲を流しただけの場合もあります。  
　複数ヒットがあった場合、同一番組は1つしか録音されません。  
　複数ヒットがあった場合、コメントタグには最初のキーワードが設定されます。  
  
### ３）キーワード比較について（参考）  
  
キーワード比較は次のようにして行っています。  
  
キーワード比較する前に、番組表、キーワードに対し以下の処理を行います。  
  
・全角英数文字を半角英数に変換します。（ABCｘｙｚ１２３ -> ABCXYZ123）  
・全角空白、半角空白を削除します。（全　角半 角 -> 全角半角）  
  
これにより、ヒットする確率が上がります。半面、誤ヒットの確率も上がります。しかし、実用上問題ないと判断しました。  
  


## 8.1 放送局  
放送局の有効・無効を設定します。  
### 1) radiko 無効ステーション定義  
指定するとその局は録音予約しません  
:radiko_ng_station  
RN1  
#RN2  
HOUSOU-DAIGAKU  
  
### 2) radiru メインステーション定義  
:radiru_main_station  
tokyo  
#sendai  
#nagoya  
#osaka  
#sapporo  
#hiroshima  
#matsuyama  
#fukuoka  
  
### 2) radiru 有効ステーション定義  
録音予約する局を指定
先頭のchは基本chとなります（通常はtokyo）  
:radiru_station  
tokyo   
#sendai  
#nagoya  
osaka  
#sapporo  
#hiroshima  
#matsuyama  
#fukuoka  
  
### 3) radiru 無効ステーション定義  
指定するとその局は録音予約しません  
:radiru_ng_station  
#r1  
#r2  
#r3  
  
## 8.2 共通  
  
ラジコ・らじるに共通のキーワードを設定します。  
全体共通のキーワードを指定します。  
興味があるパーソナリティなどを設定すると有効です。  
ラジコやらじるで、そのパーソナリティが出演する番組がヒットしやすくなります。   
:common_ng  
:common  
伊集院光  
  
## 8.3 ラジコ  
### 8.3.1 ラジコ  
ラジコのキーワードを設定します。
:radiko_timerec  
# 局名,曜日,開始,終了,タイトル,アーティスト  
#FMT,MON,22:10,22:30,GIRLS-LOCK,GIRLS  
  
:radiko_ng_program  
#らじるの時間  
:radiko  
オードリー,オールナイトニッポン  
俺のメモ帳  
  
### 8.3.2 タイムフリー  
  
ラジコタイムフリーのキーワードを設定します。  
:timefree_ng
:timefree
オールナイトニッポン  
+JUNK  
  
### 8.3.3 エリアフリー  
ラジコエリアフリーのキーワードを設定します。  
全国のラジコの番組を指定します。  
プレミアムの契約が必要です。  
  
:premium_main_station  
JP13  
:premium_station  
JP27  
:premium_common_ng  
:premium_common  
:premium_radiko_ng  
:premium_radiko  
:premium_timefree_ng  
:premium_timefree  
:premium_common_JP27  
+アッパレやってまーす!  
+ヤングタウン  
+東野幸治のホンモノラジオ  
:premium_radiko_JP27  
:premium_timefree_JP27  
  
## 8.4 らじる 
### 8.4.1 らじる  
らじるのキーワードを設定します。  
:radiru_ng  
:radiru_ng_program   
らじるの時間  
:radiru  
r1,ラジオ深夜便,ミッドナイトトーク  
  
### 8.4.2 地域  
  
らじるの地域別キーワードを設定します。  
  
:radiru_sapporo  
北海道まるごと  
  
### 8.4.3 聞き逃し  
らじるの聞き逃しのキーワードを設定します。  
:radiru_vod_ng  
:radiru_vod  
+ミュージックライン,!5分  
  
### 8.4.3 ゴガク  
らじるのゴガクのキーワードを設定します。  
:radiru_gogaku_ng  
:radiru_gogaku  
小学生の基礎英語  
ニュースで学ぶ「現代英語」  
  
## 8.5 重複番組  
放送日時は異なるが、タイトル、内容が同じものが重複して放送される(再放送有)番組を設定します。 
らじるのゴガク番組やニュース番組に多く見られます。   
![o](https://github.com/user-attachments/assets/75b63ccb-f1a4-4719-aab0-41e704b2572d)
## 8.6 番組配送  
録音した番組の配送に関する設定を行います。  
各番組録音後、番組配送設定に従って、指定ディレクトリにコピー/移動します。  
  
従来の機能を変更すると各所に影響が出るので追加機能としました。  
また、従来の転送機能と重複するところもありますが、使い分けてください。  
  
### 8.6.1 機能のON/OFF  
  
:dlvy  
on/off  
  
### 8.6.2 ユーザ指定  
  
番組配送はユーザ単位で行うため、ユーザを指定する。  
  
:dlvy_users  
ユーザ１   
ユーザ２   
...  
  
ユーザ　 処理をわけるためのユーザ  
  
### 8.6.3 番組配送先ディレクトリ指定  
  
番組を配送するディレクトリを指定する。  
ディレクトリは存在する必要がある。  
  
:dlvy_ユーザ_タイプ_dir  
ディレクトリ  
  
|||
|:---|:---|  
|ユーザ|dlvy_usersで設定したユーザ|  
|タイプ|radiko, radiru, timefree, radiru_vod, radiru_gogaku|  
|ディレクトリ|番組を配送するディレクトリ|  
  
### 8.6.4 配送番組指定  
  
どの番組をどう配送するか指定する。  
  
:dlvy_ユーザ_タイプ_コマンド  
キーワード  
  
|||
|:---|:---|
|ユーザ|dlvy_usersで設定したユーザ|   
|タイプ|radiko, radiru, timefree, radiru_vod, radiru_gogaku| 
|コマンド|copy, copyf, move, movef|   
|　copy| 番組をコピーする。配送先に同一番組がある場合はコピーしない。|  
|　copyf| 番組をコピーする。配送先に同一番組があってもコピーする。|  
|　move| 番組を移動する。　配送先に同一番組がある場合は移動しない。|  
|　movef| 番組を移動する。　配送先に同一番組があっても移動する。|  
|キーワード| 指定する番組のキーワード<br>キーワードは予約の時と同一形式。<br>特別のキーワードとして、*を指定するとすべての番組にヒットする。<br>*はdelivery用に新たに追加したもので、予約では使用できません。|  
  
### 8.6.5 サンプル  
  
#### １）radiko番組の局ごとの振り分け例を記述します。  
  
user1 TBSの番組  
user2 LFRの番組  
user3 それ以外  
  
:dlvy  
on  
  
:dlvy_users  
user1  
user2  
user3  
  
:dlvy_user1_radiko_dir  
/home/test/smbdir/TBS/  
:dlvy_user1_radiko_move  
TBS  
  
:dlvy_user2_radiko_dir  
/home/test/smbdir/LFR/  
:dlvy_user2_radiko_move  
LFR  
  
:dlvy_user3_radiko_dir  
/home/test/smbdir/other/  
:dlvy_user3_radiko_move  
*  
  
#### ２）家族用番組の振り分け例を記述します。  
  
father お父さん  
mother おかあさん  
me 自分  
  
:dlvy  
on  
  
:dlvy_users  
father  
mother  
me  
  
:dlvy_father_radiko_dir  
/home/test/smbdir/father/  
:dlvy_father_radiko_copy  
LFR,オールナイト,オードリー  
  
:dlvy_father_radiru_dir  
/home/test/smbdir/father/  
:dlvy_father_radiru_move  
深夜便  
  
:dlvy_mother_radiko_dir  
/home/test/smbdir/mother/  
:dlvy_mother_radiko_copy  
LFR,オールナイト,オードリー  
:dlvy_mother_radiko_move  
人生相談  
 
:dlvy_me_radiko_dir  
/home/test/smbdir/myself/  
:dlvy_me_radiko_move  
*  
  
:dlvy_me_radiru_dir  
/home/test/smbdir/myself/  
:dlvy_me_radikoru_move  
*  
  
### 8.6.6 注意事項  
  
#### １）番組予約と配送機能  
  
番組予約は、キーワードにマッチした番組を予約するが、 この配送機能は録音した番組が配送する番組かどうかを検索する。  
現在の録音データに関して処理するので、過去の録音データが処理されることはない。  
例えば、timefree処理で、「この番組は録音済みです」となったものは処理しない。  
  
#### ２）移動先のディレクトリ  
  
移動先のディレクトリが存在しない場合は何もしない。  
usersの記述の順番に処理を行っていくため、move設定の記述には注意が必要。  
また、転送処理の後に実行するので、転送処理で移動を指定していると処理が無効になる。  
  
#### ３）ファイル名を検索について  
  
通常のキーワード処理より検索データが少ないので同一の検索結果にはならない。  
基本的に、チャンネルとタイトルファイル名の検索と考えたほうがいい。  
番組表データは予約時のみで、録音時はタグ用のデータしか持っていないため。  
  
## 8.7 保存/復元/他  
キーワードの保存・復元を行います。
### 8.7.1 保存  
### 8.7.2 復元  
### 8.7.3 初期化    
### 8.7.4 キーワード一覧  
