## 9.1 パラメータ  
rfriends3の実行に関するパラメータの設定を行います。
### 9.1.1 表示  
### 9.1.2 編集  
  
> [!TIP] 
> [セクション名]で検索すると編集が楽になります。  
  
**[common]**  
メニューにホスト名を表示  
メニュー表示時にrfriendsのupdateをチェックする  
録音失敗時の再予約回数 (0-9)  
プログラムがハングアップした時,killする  
番組名の最大長(1-1024) バイト数  
タグ名の最大長(1-255) バイト数  
古いログを削除（0-366日）（cleanup処理時に実行）  
ユーザプロセス（録音終了時に実行するプログラム）  
  
**[schedule]**  
linux 系のジョブスケジュールタイプ  
Windows スケジューラヘッダ（Rfriends3）  
Linux　qno : "c" - "z"   
電源のスリープ設定  
  
**[reserve]**  
同一時間帯の最大予約数（1-20)  
一度に追加する最大予約数（1-100)  
予約スタンバイ時間(1-10)分  
  
**[daily]**  
デイリー処理の開始時間  
デイリー処理のon/off  
  
**[network]**  
wget option  
wget proxy  
  
**[ffmpeg]**  
ffmpeg 用共通オプション  
http_seekableオプションの設定（通常は0で変更不要）  
  
**[bluetooth]**  
utl実行(1:On 0:off)  
  
**[premium]**  
premium メニュー表示 (1:ON 0:OFF)  
ホームエリアの録音をなるべくpremiumでする(1:On 0:Off)  
  
**[radiko]**  
radiko_auth_mode(0-4)  
gps設定  
番組予約日数(1-7)  
タグのジャンル情報(radiko)  
CallSign変換　（例FMT->JOAU-FM)　 (1:on 0:off)  
timefree配信なしの番組を自動録音 (1:on 0:off)  
重複録音(0-2)  
radiko番組表のフラグの処理方法(1:有効　0:無効)  
  
**[radiru]**  
番組予約時間(1-7)  
タグのジャンル情報(radiru)  
CallSign変換　（例r1-> JOAK)　 (1:on 0:off)  
重複録音(0-2)  
  
**[timefree]**  
メニュー表示(1:ON 2:OFF)  
タグのジャンル情報(timefree)  
タイムフリー用キーワード(0-1)  
配信なしの番組を録音 (1:on 0:off)  
重複録音(0-2)  
同一ファイルがradikoに存在する場合の処理  
タイムスタンプ変更(1:on 0:off)  
ダウンロード毎の休止時間（1-10 sec）  
  
**[radiru_vod]**  
メニュー表示(1:ON 2:OFF)  
タグのジャンル情報  
vod用キーワード(0-1)  
重複録音(0-2)  
同一ファイルがradikoに存在する場合の処理  
タイムスタンプ変更(1:on 0:off)  
放送時間のチェック  
放送の部分配信のため放送時間が短い番組対策  
ダウンロード毎の休止時間（1-10 sec）  
  
**[radiru_gogaku]**  
タグのジャンル情報(radiru_gogaku)  
重複録音(0-2)  
タイムスタンプ変更(1:on 0:off)  
  
**[podcast]**  
タイムスタンプ変更(1:on 0:off)  
daily処理でダウンロード対象の日(1 - 366)  
daily処理でダウンロード最低個数(0 - 10)  
  
**[webdav]**  
webdav機能(on/off)  
webdav書き込み機能(on/off)  
  
**[refresh]**   
表示の更新間隔  
  
**[storage_control]  
録音データの管理  
  
**[backup]**  
バックアップ処理およびデイリー処理のcleanup時に実行する  
  
**[dupricate]**  
クリーンアップ時に重複ファイルの移動処理をする  
  

  

### 9.1.3 チェック  

## 9.2 タグ 
rfriends3の番組名等設定を行います。
### 9.2.1 表示  
### 9.2.2 編集  
### 9.2.3 チェック  

## 9.3 定期実行  
rfriends3のデイリー処理（定期実行）の登録・削除を行います。  
この設定は仕組みを理解した上で登録してください。  
24h稼働でない（適宜スリープ）するPCの場合は設定しないほうがいいでしょう。  

### 9.3.1 Windows  
”windows タスクスケジューラ”で検索すると良いと思います。  
### 9.3.2 Linux  
具体的にはcrontabにデイリー処理起動の設定をすることで実現しています。

## 9.4 各種データ  
### 9.4.1 ラジコcallsign  
ラジコの放送局のcallsign表示を設定します。  
### 9.4.2 らじるcallsign  
らじるの放送局のcallsign表示を設定します。  
### 9.4.3 ラジコ番組表
指定した日付のラジコの番組表を取得してます。（XML形式）  
![clip_21](https://github.com/user-attachments/assets/69faa563-b2ec-4f9e-8c42-cdf2fc1867c4)
  
log/plist/ディレクトリに保存します。  
日付      : 20241229   
area_code : JP13   
file : /home/rpi/smbdir/usr2/log/plist/radiko_20241229_JP13.xml   
/home/rpi/smbdir/usr2/log/plist/radiko_20241229_JP13.xml を出力しました。  
  
### 9.4.4 らじる番組表   
指定した日付のらじるの番組表を取得します。（JSON形式）  
![clip_22](https://github.com/user-attachments/assets/b36f7c13-7b80-45dc-83ca-0726dbf815f1)

```  
log/plist/ディレクトリに保存します。  
日付    : 20241230   
areakey : 130   
netch   : r1   
file : /home/rpi/smbdir/usr2/log/plist/radiru_20241230_130_r1.json  
/home/rpi/smbdir/usr2/log/plist/radiru_20241230_130_r1.json を出力しました。  
```
    
### 9.4.5 ラジコジャンル  
ラジコ番組のジャンル一覧です。（変更不可）  

### 9.4.6 らじるジャンル  
らじる番組のジャンル一覧です。（変更不可）  

### 9.4.7 apple podcasts  
ApplePodcastのジャンル一覧です。（変更不可）  

## 9.5 メール 
rfriends3からエラー時等のメールを送信する際の設定を行います。  
最初はsend_mail_mode = 3で試して、うまくいっているのを確認したらsend_mail_mode = 2にするのがおすすめです。  
また、メール受信側でフィルタ設定を行い、subjectにrfriendsが含まれているメールを特定フォルダに移動する設定をしておくと便利です。  

### 9.5.1 表示  
メール設定の内容を表示します。  

### 9.5.2 編集  
メール設定はメールサーバを指定する必要があります。  
GmailやYahoo-mail等が設定できますが、ここではYahoo-mailを例に説明します。  
  
自分が所持するYahoo-mailがXXXXX@yahoo.co.jpでパスワードがYYYYYとします。  
送信元のmailアドレスはFFFFF@yahoo.co.jp  
宛先のmailアドレスはTTTTT@zzzzz  
とすると、以下のような設定になります。  
  
send_mail_mode = 2                    ; 0:stop 1:error 2:error+log 3:all  
send_mail_remain = 500                ; // alarm 残容量　MB　(0-1000)  
  
send_mail_host = "smtp.mail.yahoo.co.jp" ; yahoo  
send_mail_port = 465                  ; SSL  
send_mail_user = "XXXXX"              ; 「@yahoo.co.jp」より前の部分  
send_mail_pass = "YYYYY"  
  
send_mail_from = "FFFFF@yahoo.co.jp"  ; 送信元  
send_mail_from_nm = "表示する名前1"  
send_mail_to   = "TTTTT@zzzzz"        ; 宛先  
send_mail_to_nm = "表示する名前2"  
  
### 9.5.3 メールテスト  
  
9.5.2で設定したものが正しいかどうか実際にテストメールを送信します。  
以下のようなメールがTTTTT@zzzzzに届いたら成功です。  
    
From　表示する名前1  
To　　表示する名前2  
  
[rfriends] テストメッセージ Test message  
  
This is a test mail.  
これはテストメールです。  
This is a test mail.  
これはテストメールです。  
This is a test mail.  
これはテストメールです。  
  
### 9.5.4 LINEテスト 

## 9.6 録音フォルダ  
ダウンロードした番組の保存先の設定を行います。  
指定しない場合は、rfriends3/usr , rfriends3/tmpとなります。  
tmpdはramdiskに置く必要がある等の場合を除いて変更は不要です。  

## 9.7 プレミアム  
ラジコプレミアムのユーザ設定を行います。　

### 9.7.1 表示  
### 9.7.2 編集  
ラジコプレミアムのユーザ設定を行います。  
  
[premium]  
premium = 1  
premium_mail = XXX@YYY 　　; 登録したメールアドレス  
premium_password = ****** 　; 登録したパスワード  
premium_areafree = 1       ; off:0,on:1  
premium_timefree30 = 0     ; off:0,on:1  
  
プレーンテキストファイルで保存することになりますので、不安な方は使用をお控えください。  
当方は一切情報収集はしません。また、何らかの理由で情報が漏洩しても当方は責任を持ちません。  
  
また、現在、timefree30には未対応なので、契約していても  
premium_timefree30 = 0  
をお勧めします。  
  
### 9.7.3 メインメニューにおける表示  
  
ユーザ設定が完了すると、メインメニューにpremiumの表示が出るようになります。  
以下の例は、ホームエリアは東京(JP13)で、現在地区を大阪府(JP27)にして操作しています。番組表等が大阪のものになります。  
  
prem : main: JP27 home: JP13  
ラジコ: JP27,大阪府(0)  
らじる: tokyo  
  
#### 9.7.3.1 デイリー処理や、キーワード一括録音用の設定  
  
デイリー処理や、キーワード一括録音の設定はエリアフリーで行います。  
  
#### 1) premium_main_station  
  
メインとなる地区を設定します。  
  
ここに設定された地区は、radiko のtimefree.dat,radiko.dat,common.dat をキーワードとして使用して録音を行います。  
従来のradiko の設定です。居住地区を設定するとわかりやすいと思います。  
  
:premium_main_station  
JP13  
  
#### 2) premium_station  
  
メイン地区以外に録音したいサブ地区を設定します。  
  
以下の例では、JP1(北海道)、JP40(福岡)を設定しています。  
それぞれのキーワードにマッチした番組をリアルタイム及びタイムフリーで録音します。  
  
:premium_station  
JP1  
JP40  
  
#### 3) premium_commonなど  
  
サブ地区で共通に使用するキーワードを設定します。  
それぞれの機能は、通常のキーワードに準じます。  
  
:premium_common  
キーワード１  
キーワード２  
:premium_radiko  
キーワード３  
:premium_timefree  
キーワード４  
  
#### 4) premium_common_JPXXなど  
  
サブ地区で共通に使用するキーワードを設定します。  
それぞれの機能は、通常のキーワードに準じます。  
  
:premium_common_JP1  
キーワード５  
キーワード６  
:premium_radiko_JP1  
キーワード７  
:premium_timefree_JP1  
キーワード８  
  
:premium_common_JP40  
キーワード９  
:premium_radiko_JP40  
:premium_timefree_JP40  
  
#### 9.7.3.2 地区番号  
  
地区番号は以下のとおりです。  
１桁の地区番号は、例えばJP01ではありません、JP1です。  
  
1 北海道 2 青森県 3 岩手県 4 宮城県 5 秋田県  
6 山形県 7 福島県 8 茨城県 9 栃木県 10 群馬県  
11 埼玉県 12 千葉県 13 東京都 14 神奈川県 15 新潟県  
16 富山県 17 石川県 18 福井県 19 山梨県 20 長野県  
21 岐阜県 22 静岡県 23 愛知県 24 三重県 25 滋賀県  
26 京都府 27 大阪府 28 兵庫県 29 奈良県 30 和歌山県  
31 鳥取県 32 島根県 33 岡山県 34 広島県 35 山口県  
36 徳島県 37 香川県 38 愛媛県 39 高知県 40 福岡県  
41 佐賀県 42 長崎県 43 熊本県 44 大分県 45 宮崎県  
46 鹿児島県 47 沖縄県  

## 9.8 保存/復元/他  
設定値の保存・復元を行います。
### 9.8.1 保存  
各種設定情報を保存します。  
![hozon1](https://github.com/user-attachments/assets/7891521f-9d33-42e2-b0d9-ee643f9a7b00)

### 9.8.2 復元  
あらかじめ保存していた各種設定情報を復元します。  
### 9.8.3 初期化  
各種設定情報を初期化します。  
初期化する項目は選択できます。  
![hozon3](https://github.com/user-attachments/assets/e11b2593-13ab-40fc-a5c6-cb6d418bd9ec)


